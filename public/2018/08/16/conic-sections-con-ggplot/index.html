<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Hugo 0.46" />


<title>Conic sections con ggplot - rlabuonora</title>
<meta property="og:title" content="Conic sections con ggplot - rlabuonora">



  








<link href='//cdn.bootcss.com/highlight.js/9.11.0/styles/github.min.css' rel='stylesheet' type='text/css' />



<link rel="stylesheet" href="/css/fonts.css" media="all">
<link rel="stylesheet" href="/css/main.css" media="all">



  </head>
  <body>
    <div class="wrapper">
      <header class="header">
        <nav class="nav">
  <a href="/" class="nav-logo">
    <img src="/images/logo.png"
         width="50"
         height="50"
         alt="Logo">
  </a>

  <ul class="nav-links">
    
    <li><a href="https://github.com/rlabuonora">GitHub</a></li>
    
    <li><a href="https://twitter.com/rlabuonora">Twitter</a></li>
    
    <li><a href="http://www.rlabuonora.com">Web</a></li>
    
  </ul>
</nav>

      </header>


<main class="content" role="main">

  <article class="article">
    
    <span class="article-duration">4 min read</span>
    

    <h1 class="article-title">Conic sections con ggplot</h1>

    
    <span class="article-date">2018/08/16</span>
    

    <div class="article-content">
      <div id="circle" class="section level2">
<h2>Circle</h2>
<p>The set of all points equidistant from a fixed point (h, k), called the center of the circle.</p>
<p><span class="math display">\[(x-h)^2 + (y-k)^2 = r^2\]</span></p>
<pre class="r"><code>ejes &lt;-  ggplot() + 
  geom_segment(aes(x=-5, xend = 5, y=0, yend=0),
               size = 0.5,
               arrow = arrow(length = unit(0.2, &quot;cm&quot;))) +
  geom_segment(aes(x=0, xend=0, y=-1, yend=1.2),
               size = 0.5,
               lineend = &quot;butt&quot;,
               arrow = arrow(length = unit(0.2, &quot;cm&quot;))) +
  NULL</code></pre>
</div>
<div id="problem" class="section level2">
<h2>Problem</h2>
<p>The point <code>(1, 4)</code> is on a circle whose center is at <code>(-2, -3)</code>. Write the standard form of the cirlce.</p>
<pre class="r"><code># find the euclidean distance btw two points
my_dist &lt;- function(x, y) { sqrt(sum((x-y)^2)) }</code></pre>
<pre class="r"><code>
center &lt;- c(-2, -3)
center
## [1] -2 -3
point &lt;- c(1, 4)
point
## [1] 1 4
#  the radius is distance btw point and center
radius &lt;- my_dist(center, point)
radius
## [1] 7.615773</code></pre>
<p><span class="math display">\[(x+2)^2 + (y+3)^2 = 58\]</span></p>
</div>
<div id="complete-the-square-to-find-a-circle" class="section level2">
<h2>Complete the square to find a circle</h2>
<p><span class="math display">\[x^2-6x+y^2-2y+6\]</span> is really <span class="math display">\[(x-3)^2+(y-1)^2 = 4\]</span></p>
<p>Plot it per <a href="https://stackoverflow.com/questions/6862742/draw-a-circle-with-ggplot2">this stackoverflow question</a></p>
<pre class="r"><code>center &lt;- c(x=3, y=1)
pt1 &lt;- c(x=1, y=1)
pt2 &lt;- c(x=5, y=1)
pt3 &lt;- c(x=3, y=3)
pt4 &lt;- c(x=3, y=-1)
pts &lt;- bind_rows(center, pt1, pt2, pt3, pt4)
radius &lt;- 2
t &lt;- seq(0, 2*pi, length.out = 100)



g &lt;- ggplot() + 
  geom_segment(aes(x=-1, xend = 6, y=0, yend=0),
               size = 0.5,
               arrow = arrow(length = unit(0.2, &quot;cm&quot;))) +
  geom_segment(aes(x=0, xend=0, y=-1, yend=4),
               size = 0.5,
               lineend = &quot;butt&quot;,
               arrow = arrow(length = unit(0.2, &quot;cm&quot;))) +
  annotate(&quot;path&quot;, 
           x = center[1] + radius * cos(t),
           y = center[2] + radius * sin(t)) + 
  geom_point(data = pts, aes(x=x, y =y)) + 
  geom_text(data = pts,
            parse = TRUE,
            nudge_y = 0.3,
            aes(x=x, y=y, label = paste0(&quot;list(&quot;, x ,&quot;,&quot;, y, &quot;)&quot;))) +
  labs(x=&quot;&quot;, y=&quot;&quot;) + 
  ggtitle(TeX(&quot;(x-3)^2+(y-1)^2=4&quot;)) + 
  coord_fixed()
g</code></pre>
<p><img src="/post/2018-08-16-conic-sections-con-ggplot_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
</div>
<div id="parabola" class="section level2">
<h2>Parabola</h2>
<p>The set of point equidistante from a point (focus) and a line (directrix).</p>
<div id="equation" class="section level3">
<h3>Equation</h3>
<p><span class="math inline">\((x-h)^2=4p(y-k), p \neq 0\)</span> With vertex at <span class="math inline">\((h,k)\)</span> vertical axis and directrix <span class="math inline">\(y=k-p\)</span>.</p>
</div>
<div id="example" class="section level3">
<h3>Example</h3>
<p><span class="math inline">\(x^2=16y\)</span> is a parabola with vertex at <span class="math inline">\((0,0)\)</span>, <span class="math inline">\(p = 4\)</span> and focus in <span class="math inline">\((0,4)\)</span>.</p>
<pre class="r"><code>focus &lt;- list(x=0, y=4, lab = &quot;Focus&quot;)
vertex &lt;- list(x=0, y=0, lab = &quot;Vertex&quot;)
notable_points &lt;- bind_rows(focus, 
                            vertex)

pt &lt;- data_frame(x=5, y=round(5^2/16, 2))

p &lt;- ggplot(data_frame(x=0), aes(x=x)) +
  geom_segment(aes(x=-9, xend = 9, y=0, yend=0),
               size = 0.5,
               arrow = arrow(length = unit(0.2, &quot;cm&quot;))) + # Eje X
  geom_segment(aes(x=0, xend=0, y=-5, yend=10),
               size = 0.5,
               lineend = &quot;butt&quot;,
               arrow = arrow(length = unit(0.2, &quot;cm&quot;))) + # Eje Y
  stat_function(fun = function(x) { x^2 / 16}) + 
  xlim(-9, 9) + 
  ylim(-5, 10)

p_annotated &lt;- p +
  geom_point(data = notable_points, aes(x=x, y=y)) + 
  geom_text(data=notable_points, 
            size = 3,
            nudge_y = 1.25,
            nudge_x = 1.25,
            aes(label = paste0(lab, &quot;\n(&quot;, x, &quot;,&quot;, y, &quot;)&quot;), 
                x = x, y = y)) + 
  geom_hline(yintercept = -4, linetype = &quot;dashed&quot;) + 
  annotate(&quot;text&quot;, x= 3, y= -3.3, label = &quot;Directrix&quot;, size = 3) +
  
  ggtitle(TeX(&#39;$y=x^2/16$&#39;)) + 
  theme(
    plot.title = element_text(hjust = 0.5)
  ) +
  NULL

x &lt;- 5
p_equipoints &lt;- p_annotated + geom_point(data = pt, aes(x=x, y=y)) + 
  geom_segment(aes(x= focus$x, y=focus$y, xend=pt$x, yend=pt$y),
               linetype = &quot;dashed&quot;) + 
  geom_segment(aes(x=pt$x, y=pt$y, xend=pt$x, yend = -4),
               linetype = &quot;dashed&quot;) + 
  annotate(&quot;text&quot;, 
           label = &quot;phantom(0) == phantom(0)&quot;, 
           parse = TRUE,
           angle = 60,
           size = 5,
           x = 2.5, y= 2.85) + 
  annotate(&quot;text&quot;, 
           label = &quot;phantom(0) == phantom(0)&quot;, 
           parse = TRUE,
           size = 5,
           x = 5, y= -2) + 
  annotate(&quot;text&quot;)
p_equipoints</code></pre>
<p><img src="/post/2018-08-16-conic-sections-con-ggplot_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>You can plot it with annotate using parametric equations:</p>
<pre class="r"><code>t &lt;- seq(-5, 5, length.out = 100)
g &lt;- ggplot() + 
  annotate(&quot;path&quot;, 
           x=  t,
           y =  t^2) + 
  xlim(-5, 5) +
  geom_segment(aes(x=-5, xend = 5, y=0, yend=0),
               size = 0.5,
               arrow = arrow(length = unit(0.2, &quot;cm&quot;))) + # Eje X
  geom_segment(aes(x=0, xend=0, y=-1, yend=25),
               size = 0.5,
               lineend = &quot;butt&quot;,
               arrow = arrow(length = unit(0.2, &quot;cm&quot;))) + # Eje Y 
  ggtitle(TeX(&#39;$y=x^2$&#39;)) + 
  theme(
    plot.title = element_text(hjust = 0.5)
  ) +
  NULL
g</code></pre>
<p><img src="/post/2018-08-16-conic-sections-con-ggplot_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>Or stat_fun:</p>
<pre class="r"><code>library(latex2exp)

fun.1 &lt;- function(x) { x^2 }
p &lt;- ggplot(data_frame(x=0), aes(x=x))
p + 
  stat_function(fun = fun.1) + xlim(-5, 5) + 
  geom_segment(aes(x=-5, xend = 5, y=0, yend=0),
               size = 0.5,
               arrow = arrow(length = unit(0.2, &quot;cm&quot;))) + # Eje X
  geom_segment(aes(x=0, xend=0, y=-1, yend=25),
               size = 0.5,
               lineend = &quot;butt&quot;,
               arrow = arrow(length = unit(0.2, &quot;cm&quot;))) + # Eje Y 
  ggtitle(TeX(&#39;$y=x^2$&#39;)) + 
  theme(
    plot.title = element_text(hjust = 0.5)
  ) +
  NULL</code></pre>
<p><img src="/post/2018-08-16-conic-sections-con-ggplot_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</div>
</div>
<div id="reflecting-incoming-rays" class="section level2">
<h2>Reflecting incoming rays</h2>
</div>
<div id="another-example" class="section level2">
<h2>Another Example</h2>
Complete the
<span class="math display">\[\begin{align}
y^2+6y+8x+25 &amp;= 0\\
y^2+6y+9+8x+25-9  &amp;= 0\\
(y+3)^2 &amp;= -16-8x\\
(y+3)^2 &amp;= 4(-2)(x+2)
\end{align}\]</span>
Vertex is <span class="math inline">\((-2, -3)\)</span>, p is <span class="math inline">\(-2\)</span>, focus is <span class="math inline">\((-4,-3)\)</span> directrix is <span class="math inline">\(x=0\)</span>. But this parabola is not a function. How do we plot it? Break it in two pieces.
<span class="math display">\[\begin{align}
(y+3)^2 &amp;= (-8)(x+2)\\
y     &amp;= -3 \pm \sqrt{-8(x+2)}\\
y_1  &amp;=-3 + \sqrt{-8(x+2)}\\
y_2 &amp;=-3 - \sqrt{-8(x+2)}\\
\end{align}\]</span>
<p>Graph those <span class="math inline">\(y1\)</span> and <span class="math inline">\(y2\)</span>:</p>
<pre class="r"><code>x &lt;- seq(-5, 0, length.out=1e3)
lbs &lt;- list(bquote(-3 + sqrt(-8*(x+2))), # investigar bquote!
            bquote(-3 - sqrt(-8*(x+2))))

g &lt;- ggplot(data_frame(x=x), 
            aes(x=x, color = color)) + 
  stat_function(data = data_frame(x=x, color = factor(1)),
                fun = function(x) { -3 + sqrt(-8*(x+2)) }) + 
  stat_function(data = data_frame(x=x, color = factor(2)),
                fun = function(x) { -3 - sqrt(-8*(x+2)) }) + 
  scale_color_manual(labels = lbs,
                     name = &quot;&quot;,
                     values = c(scales::hue_pal()(2)[1], 
                                scales::hue_pal()(2)[2])) + 
  geom_hline(yintercept = 0) + 
  geom_vline(xintercept = 0)
g</code></pre>
<p><img src="/post/2018-08-16-conic-sections-con-ggplot_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>

    </div>
  </article>

  


</main>

      <footer class="footer">
        <ul class="footer-links">
          <li>
            <a href="/index.xml" type="application/rss+xml" target="_blank">RSS feed</a>
          </li>
          <li>
            <a href="https://gohugo.io/" class="footer-links-kudos">Made with <img src="/images/hugo-logo.png" alt="Img link to Hugo website" width="22" height="22"></a>
          </li>
        </ul>
      </footer>

    </div>
    



<script src="//cdn.bootcss.com/highlight.js/9.11.0/highlight.min.js"></script>



<script src="//cdn.bootcss.com/highlight.js/9.11.0/languages/r.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.11.0/languages/yaml.min.js"></script>
<script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>



    
<script src="/js/math-code.js"></script>
<script async src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>


    
  </body>
</html>

